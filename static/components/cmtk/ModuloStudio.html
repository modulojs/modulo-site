!DOCTYPE_MODULO(`

<Props
    value
    layout
    files
></Props>

<State
    text:=null
    menu:=null
    editing:=null
    viewing:=null
    runcount:=0
></State>

<!--
    preview-mode="component"
    preview-element="x_DemoUsage"
    NOTE: Will need to start working on this via HTTP, but then export to a
    version that properly bootstraps Modulo.js and VBrowser etc
    ../../js/Modulo.js
    ../../js/VBrowser.js
 demo-loading="<iframe></iframe>" demo-code="<iframe></iframe>">
-->
<VBrowser>
    ./ComponentEditor.html
    ./WebEditor.html
    ./parts/EditorBase.html
    ./parts/EditorBase.css
</VBrowser>

<Template -src="./parts/EditorBase.html"></Template>
<Style -src="./parts/EditorBase.css"></Style>
<Style -src="./parts/EditorBase-toggleBar.css"></Style>


<State
    -name="info_state"
    buffers:='[ "usage", "component" ]'
    name="App"
    modulo-url="./static/js/Modulo.js"
></State>

<Template -file="index.html" -name="index_template" -default-view>
    <style>
        h1 {
            font-family: monospace;
            text-align: center;
            margin-top: 30vh;
            font-size: 5vw;
            color: white;
            --color: #B90183;
            text-shadow: 0 0 2px var(--color);
        }
    </style>
    <h3>&larr; Start a new project, or open an existing one.</h3>
    <h1>Modulo Studio</h1>
</Template>

<Template -file="ce_editor_example.html" -name="component_editor_example" >
    <div></div>
    <template Modulo>
        <Component -src="./static/components/cmtk/ComponentEditor.html" name="ComponentEditor"></Component>
    </template>
    <link rel="stylesheet" href="./static/css/site.css" />
    <script src="./static/js/Modulo.js"></script>
    <script src="./static/js/VBrowser.js"></script>
    <x-ComponentEditor class="fullscreen-mode"></x-ComponentEditor>
</Template>


<Template -file="editor_basic_website.html" -name="editor_basic_website" >
    <div></div>
    <template Modulo>
        <Component -src="./static/components/cmtk/WebEditor.html" name="WebEditor"></Component>
    </template>
    <script src="./static/js/Modulo.js"></script>
    <script src="./static/js/VBrowser.js"></script>
    <x-WebEditor class="fullscreen-mode"></x-WebEditor>
</Template>

<Template -button="menu" -button-label=" " -button-emoji="%" -name="hide_template" -default-edit>
    &nbsp;
</Template>

<Template -button="open" -button-emoji="&#128193;" -name="open_menu_template">
    <div class="toolbar toolbar--settings">
        <h2>Recent</h2>
        <div class="control-section">
            {% for file in vbrowser.recent %}
                <button @click:=vbrowser.view payload="{{ file.filename }}">{{ file.title }}</button>
            {% empty %}
                <em>No recent projects found.</em>
            {% endfor %}
        </div>
    </div>

    <h2>Import</h2>
    <!-- ability to open zip? -->

</Template>

<Template -button="new" -button-emoji="&#x1f4c4;" -name="new_menu_template">
    <div class="toolbar toolbar--settings">
        <h3>Web Site</h3>
        <div class="control-section">
            <button @click:=vbrowser.view payload="editor_basic_website.html"><span>&#128193;</span> Multi-Page Site</button>
        </div>
        <h3>React.js</h3>
        <div class="control-section">
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Single Page App</button>
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Next.js</button>
        </div>
        <h3>Vue.js</h3>
        <div class="control-section">
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Single Page App</button>
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Nuxt.js</button>
        </div>
        <h3>Modulo.js</h3>
        <div class="control-section">
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Multi-Page Site</button>
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Single Page App</button>
            <button @click:=vbrowser.view payload="ce_editor_example.html"><span>&#128193;</span> Component</button>
        </div>
    </div>

</Template>

<Template -button="opts" -button-emoji="&#x22EF;" -name="opts_menu_template">
    <div class="toolbar toolbar--settings">
        <h3>Opts in Progress</h3>
    </div>

</Template>


<Script>
    function prepareCallback() {
        const { divider, dividerLast } = vbrowser.settings;
        if (vbrowser.menu === null) {
            if (vbrowser.editing === null) {
                vbrowser.settings.divider = 100; // 100% preview
            } else {
                vbrowser.settings.divider = vbrowser.settings.dividerSplit; // 100% preview
            }
        } else if (vbrowser.menu === 'menu') {
            vbrowser.settings.divider = 95; // 90% preview
        } else {
            vbrowser.settings.divider = vbrowser.settings.dividerSplit; // 100% preview
        }
        //} else if (dividerLast || dividerLast == 0) {
        //    vbrowser.settings.divider = dividerLast; // restore
        // Ensure full-screen size (if not FS layout)
        vbrowser.settings.extraPaneStyle = 'height: 100vh; width: 100vw; overflow: hidden; position: absolute; top: 0; left: 0;';
    }
</Script>

`)
