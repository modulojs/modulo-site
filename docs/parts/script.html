<!DOCTYPE html><html><head><meta name="charset" charset="utf8" id="include_xxm0qoac"><meta name="content-type" http-equiv="Content-Type" content="text/html; charset=utf-8" id="include_xxnd8o0e"><meta name="viewport" content="width=device-width, initial-scale=1" id="include_x13l7u56"><meta name="robots" content="index, follow" id="include_xxriq75n"><meta name="revisit-after" content="30 days" id="include_x1m4jm9p"><link rel="stylesheet" href="../build-xxplgqrl.css">

<script defer="" src="../build-xxquecrj.js"></script>
</head><body><x-page rootat="https://modulohtml.org/">
        <meta charset="utf8">
        <title>Script - Component Parts - Modulo Documentation</title>
    
    <div class="layout Page">
        <nav class="page-nav Page">
            
            <a style="font-size:60px;text-align:center;display:block;font-weight:200" href="../" class="Page">ᵐ°dᵘ⁄o</a>
            <ul style="position: sticky; top: 1px" class="Page">
                <li class="toc--outer Page">
                    <p><a style="font-size: 70%" title="Download Modulo Docs as a offline-friendly zip" href="https://codeberg.org/modulo/docs/archive/main.zip" class="Page">
                            ⤓ docs-main.zip</a>
                        <tt>v0.1.0</tt>
                    </p>
                </li>
            
                
                    <li class="toc--outer Page"><h3 class="Page">       Modulo</h3></li>
                    <li class="toc--"><a href="../start/index.html" class="Page">           Introduction</a></li>
                
                    
                    <li class="toc--"><a href="../start/getting-started.html" class="Page"> Getting Started</a></li>
                
                    <li class="toc--outer Page"><h3 class="Page">           Definitions</h3></li>
                    <li class="toc--"><a href="../defs/overview.html" class="Page">         Overview</a></li>
                
                    
                    <li class="toc--"><a href="../defs/importing.html" class="Page">        Importing</a></li>
                
                    
                    <li class="toc--"><a href="../defs/definitions.html" class="Page">      Definition Types</a></li>
                
                    
                    <li class="toc--"><a href="../defs/processors.html" class="Page">       Processors</a></li>
                
                    
                    <li class="toc--"><a href="../defs/custom.html" class="Page">           Custom Types</a></li>
                
                    <li class="toc--outer Page"><h3 class="Page">  Templating</h3></li>
                    <li class="toc--"><a href="../templating/index.html" class="Page">      Language Overview</a></li>
                
                    
                    <li class="toc--"><a href="../templating/filters.html" class="Page">    Template Filters</a></li>
                
                    
                    <li class="toc--"><a href="../templating/tags.html" class="Page">       Template Tags</a></li>
                
                    <li class="toc--outer Page"><h3 class="Page">              Component Parts</h3></li>
                    <li class="toc--"><a href="../parts/props.html" class="Page">           Props</a></li>
                
                    
                    <li class="toc--active Page"><a href="../parts/script.html" class="Page">          Script</a></li>
                
                    
                    <li class="toc--"><a href="../parts/state.html" class="Page">           State</a></li>
                
                    
                    <li class="toc--"><a href="../parts/staticdata.html" class="Page">      StaticData</a></li>
                
                    
                    <li class="toc--"><a href="../parts/style.html" class="Page">           Style</a></li>
                
                    
                    <li class="toc--"><a href="../parts/template.html" class="Page">        Template</a></li>
                
                    <li class="toc--outer Page"><h3 class="Page">           Core Definitions</h3></li>
                    <li class="toc--"><a href="../core/artifact.html" class="Page">         Artifact</a></li>
                
                    
                    <li class="toc--"><a href="../core/component.html" class="Page">        Component</a></li>
                
                    
                    <li class="toc--"><a href="../core/configuration.html" class="Page">    Configuration</a></li>
                
                    
                    <li class="toc--"><a href="../core/contentlist.html" class="Page">      ContentList</a></li>
                
                    
                    <li class="toc--"><a href="../core/include.html" class="Page">          Include</a></li>
                
                    
                    <li class="toc--"><a href="../core/library.html" class="Page">          Library</a></li>
                
                    <li class="toc--outer Page"><h3 class="Page">  Extension</h3></li>
                    <li class="toc--"><a href="../extension/engine.html" class="Page">      Upgrading Engines</a></li>
                
            </ul>
        </nav>
        <main class="page-container Page">
            
                
                    
                        <x-tableofcontents toc="[{&quot;match&quot;:&quot;&lt;h1 id=\&quot;script\&quot;&gt;Script&lt;/h1&gt;&quot;,&quot;level&quot;:1,&quot;attrs&quot;:&quot;id=\&quot;script\&quot;&quot;,&quot;title&quot;:&quot;Script&quot;,&quot;id&quot;:&quot;script&quot;},{&quot;match&quot;:&quot;&lt;h2 id=\&quot;typicaluse\&quot;&gt;Typical use&lt;/h2&gt;&quot;,&quot;level&quot;:2,&quot;attrs&quot;:&quot;id=\&quot;typicaluse\&quot;&quot;,&quot;title&quot;:&quot;Typical use&quot;,&quot;id&quot;:&quot;typicaluse&quot;},{&quot;match&quot;:&quot;&lt;h2 id=\&quot;eventcallbacks\&quot;&gt;Event callbacks&lt;/h2&gt;&quot;,&quot;level&quot;:2,&quot;attrs&quot;:&quot;id=\&quot;eventcallbacks\&quot;&quot;,&quot;title&quot;:&quot;Event callbacks&quot;,&quot;id&quot;:&quot;eventcallbacks&quot;},{&quot;match&quot;:&quot;&lt;h2 id=\&quot;domreferences\&quot;&gt;DOM references&lt;/h2&gt;&quot;,&quot;level&quot;:2,&quot;attrs&quot;:&quot;id=\&quot;domreferences\&quot;&quot;,&quot;title&quot;:&quot;DOM references&quot;,&quot;id&quot;:&quot;domreferences&quot;},{&quot;match&quot;:&quot;&lt;h3 id=\&quot;scriptref\&quot;&gt;script.ref&lt;/h3&gt;&quot;,&quot;level&quot;:3,&quot;attrs&quot;:&quot;id=\&quot;scriptref\&quot;&quot;,&quot;title&quot;:&quot;script.ref&quot;,&quot;id&quot;:&quot;scriptref&quot;},{&quot;match&quot;:&quot;&lt;h5 id=\&quot;example1usingscriptreftofocusinput\&quot;&gt;Example 1: Using script.ref to focus input&lt;/h5&gt;&quot;,&quot;level&quot;:5,&quot;attrs&quot;:&quot;id=\&quot;example1usingscriptreftofocusinput\&quot;&quot;,&quot;title&quot;:&quot;Example 1: Using script.ref to focus input&quot;,&quot;id&quot;:&quot;example1usingscriptreftofocusinput&quot;},{&quot;match&quot;:&quot;&lt;h5 id=\&quot;example2scriptrefnaminganddrillingdown\&quot;&gt;Example 2: Script.ref naming and drilling down&lt;/h5&gt;&quot;,&quot;level&quot;:5,&quot;attrs&quot;:&quot;id=\&quot;example2scriptrefnaminganddrillingdown\&quot;&quot;,&quot;title&quot;:&quot;Example 2: Script.ref naming and drilling down&quot;,&quot;id&quot;:&quot;example2scriptrefnaminganddrillingdown&quot;},{&quot;match&quot;:&quot;&lt;h1 id=\&quot;lifecyclecallbacks\&quot;&gt;Lifecycle callbacks&lt;/h1&gt;&quot;,&quot;level&quot;:1,&quot;attrs&quot;:&quot;id=\&quot;lifecyclecallbacks\&quot;&quot;,&quot;title&quot;:&quot;Lifecycle callbacks&quot;,&quot;id&quot;:&quot;lifecyclecallbacks&quot;},{&quot;match&quot;:&quot;&lt;h5 id=\&quot;example1preparecallback\&quot;&gt;Example 1: prepareCallback&lt;/h5&gt;&quot;,&quot;level&quot;:5,&quot;attrs&quot;:&quot;id=\&quot;example1preparecallback\&quot;&quot;,&quot;title&quot;:&quot;Example 1: prepareCallback&quot;,&quot;id&quot;:&quot;example1preparecallback&quot;},{&quot;match&quot;:&quot;&lt;h5 id=\&quot;example2allcallbacks\&quot;&gt;Example 2: All callbacks&lt;/h5&gt;&quot;,&quot;level&quot;:5,&quot;attrs&quot;:&quot;id=\&quot;example2allcallbacks\&quot;&quot;,&quot;title&quot;:&quot;Example 2: All callbacks&quot;,&quot;id&quot;:&quot;example2allcallbacks&quot;},{&quot;match&quot;:&quot;&lt;h2 id=\&quot;manualhtmlcreationwithscript\&quot;&gt;Manual HTML creation with Script&lt;/h2&gt;&quot;,&quot;level&quot;:2,&quot;attrs&quot;:&quot;id=\&quot;manualhtmlcreationwithscript\&quot;&quot;,&quot;title&quot;:&quot;Manual HTML creation with Script&quot;,&quot;id&quot;:&quot;manualhtmlcreationwithscript&quot;},{&quot;match&quot;:&quot;&lt;h6 id=\&quot;example1scriptwithouttemplate\&quot;&gt;Example 1: Script without Template&lt;/h6&gt;&quot;,&quot;level&quot;:6,&quot;attrs&quot;:&quot;id=\&quot;example1scriptwithouttemplate\&quot;&quot;,&quot;title&quot;:&quot;Example 1: Script without Template&quot;,&quot;id&quot;:&quot;example1scriptwithouttemplate&quot;},{&quot;match&quot;:&quot;&lt;h6 id=\&quot;example2scriptwithoutvirtualdom\&quot;&gt;Example 2: Script without Virtual DOM&lt;/h6&gt;&quot;,&quot;level&quot;:6,&quot;attrs&quot;:&quot;id=\&quot;example2scriptwithoutvirtualdom\&quot;&quot;,&quot;title&quot;:&quot;Example 2: Script without Virtual DOM&quot;,&quot;id&quot;:&quot;example2scriptwithoutvirtualdom&quot;}]" modulo-mount-html=""><nav class="regular&quot;=&quot;">
        <div> </div>
        <div>
            <div>
                <label>[ <input name="show" type="checkbox"> Table of Contents ]</label>
                <label title="Stick to upper right">[ <span alt="upper right arrow">↗</span>
                    <input name="sticky" type="checkbox"> ]</label>
            </div>
            
                <ul>
                    
                        
                            <li style="--level: 1">
                                    <a href="#script">Script</a>
                            </li>
                        
                    
                        
                            <li style="--level: 2">
                                    <a href="#typicaluse">Typical use</a>
                            </li>
                        
                    
                        
                            <li style="--level: 2">
                                    <a href="#eventcallbacks">Event callbacks</a>
                            </li>
                        
                    
                        
                            <li style="--level: 2">
                                    <a href="#domreferences">DOM references</a>
                            </li>
                        
                    
                        
                            <li style="--level: 3">
                                    <a href="#scriptref">script.ref</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li style="--level: 1">
                                    <a href="#lifecyclecallbacks">Lifecycle callbacks</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                            <li style="--level: 2">
                                    <a href="#manualhtmlcreationwithscript">Manual HTML creation with Script</a>
                            </li>
                        
                    
                        
                    
                        
                    
                </ul>
            
        </div>
    </nav></x-tableofcontents>
                    
                    <div class="markdown-body"><blockquote>
  <p><strong>Custom vs Script Component Part</strong> - The general rule of thumb is that
  <em>Script</em> tags are for custom, component-specific behavior, or to fill in gaps
  in stitching together other Component Parts, while writing Custom Component
  Parts is for interfacing with async, APIs, or any time that a Script
  Component Part gets too cumbersome. Modulo's philosophy is to allow
  separation of work between <em>component development</em> (HTML, CSS, templating,
  and high-level behavior), and <em>Component Part development</em> (complex
  JavaScript and APIs).</p>
</blockquote>
<h1 id="script">Script</h1>
<p><em>Script</em> Component Parts allow you to define custom behavior for components using the
full power of JavaScript. The most common use of <em>Script</em> tags is to add more
sophisticated interactive behavior. Instead of just relying on premade Component Parts,
with a Script tag you can program any custom behavior into your component.</p>
<h2 id="typicaluse">Typical use</h2>
<p>The most common use of a <em>Script</em> Component Part is to specify custom JS code.
See below for a simple example:</p><x-quickdemo mode="modulo" value="&lt;Component name=&quot;ButtonExample&quot;&gt;
    &lt;Template&gt;...&lt;/Template&gt;
    &lt;State&gt;...&lt;/State&gt;
    &lt;Script&gt;
        function initializedCallback() {
            console.log(&quot;Executes every time an instance of ButtonExample is created&quot;);
        }
        function updateCallback() {
            console.log(&quot;Executes after every rerender of the component&quot;);
        }
    &lt;/Script&gt;
&lt;/Component&gt;
" modulo-mount-html=""></x-quickdemo>
<h2 id="eventcallbacks">Event callbacks</h2>
<p>The most common purpose of a Script Component Part is to add custom behavior
when certain "events" occur to your component. Consider the following example
of 3 click events:</p><x-quickdemo mode="modulo" demo="modulo" value="&lt;Template&gt;
    &lt;button on.click=script.doConsole&gt;Console Log&lt;/button&gt;
    &lt;button on.click=script.doAlert&gt;Show Alert&lt;/button&gt;
    &lt;button on.click=script.countUp&gt;Counter {{ state.num }}&lt;/button&gt;
&lt;/Template&gt;
&lt;State
    num:=42
&gt;&lt;/State&gt;
&lt;Script&gt;
    function doConsole() {
        console.log(&quot;Event callback. State.num is:&quot;, state.num);
    }
    function doAlert() {
        alert(&quot;Event callback. State.num is: &quot; + state.num);
    }
    function countUp() {
        state.num++;
    }
&lt;/Script&gt;
" modulo-mount-html=""></x-quickdemo>
<p>In this, the <em>Script</em> Component Part defines a function named <code>countUp</code>. The <code>on.click=</code>
attribute on the button utilizes directives to attach a "click event" to the
button, such that when a user clicks on that button it will invoke the
<code>countUp</code> function.</p>
<p>From within event callbacks, the <em>Script</em> Component Part exposes the current renderObj as variables. So, <code>state</code> by itself is equivalent to <code>renderObj.state</code>. This enables us to directly modify the state by simply doing <code>state.count++</code>. By default, components rerender after every event, so after the event the component will rerender and visually reflect the state changes.</p>
<p>This means that all renderObj variables will be available here, in a similar way to how <em>Template</em> exposes them: For example, you can use code like <code>props.XYZ</code> to access data from a <em>Props</em> Component Part.</p>
<p>You can also access the JavaScript Object instances of the Component Part Class. To access those, you use the <code>cparts</code></p>
<p>Finally, the variable <code>element</code> will refer to the HTML element of the current component. This is useful for direct DOM manipulation or interfacing with other frameworks or "vanilla" JavaScript. Generally, however, you should avoid direct DOM manipulation whenever you can, instead using a <em>Template</em> Component Part to render the component (otherwise, the <em>Template</em> will override whatever direct manipulation you do!).</p>
<h2 id="domreferences">DOM references</h2>
<h3 id="scriptref">script.ref</h3>
<p>Using <code>script.ref</code>, we can get easy access to DOM elements. See below for
examples:</p>
<h5 id="example1usingscriptreftofocusinput">Example 1: Using script.ref to focus input</h5><x-quickdemo mode="modulo" demo="modulo" value="&lt;Template&gt;
    &lt;button on.click=script.focusOnInput&gt;Set focus to input&lt;/button&gt;
    &lt;input script.ref&gt;
&lt;/Template&gt;

&lt;Script&gt;
    function focusOnInput() {
        ref.input.focus()
        console.log(ref.input)
    }
&lt;/Script&gt;
" modulo-mount-html=""></x-quickdemo>
<h5 id="example2scriptrefnaminganddrillingdown">Example 2: Script.ref naming and drilling down</h5>
<p>Using a suffix we can provide a custom name. For example, the directive
<code>script.ref.firstname</code> becomes <code>ref.firstname</code>.</p>
<p>By specifying a value, we can "drill down" to properties of the element. For
example, to access the built in <code>style</code> attribute, you can do
<code>script.ref=style</code>.</p><x-quickdemo mode="modulo" demo="modulo" value="&lt;Template&gt;
    &lt;button on.click=script.scrollMe&gt;Scroll to bottom&lt;/button&gt;
    &lt;div script.ref=style&gt;Styled directly...&lt;/div&gt;
    &lt;h1 script.ref.target&gt;BOTTOM!&lt;/h1&gt;
&lt;/Template&gt;

&lt;Script&gt;
    function scrollMe() {
        ref.target.scrollIntoView()
    }
    function updateCallback() {
        if (ref.div) {
            ref.div.backgroundColor = 'pink'
            ref.div.padding = '10px'
            ref.div.height = '400px'
        }
    }
&lt;/Script&gt;
" modulo-mount-html=""></x-quickdemo>
<h1 id="lifecyclecallbacks">Lifecycle callbacks</h1>
<p>By naming functions with certain names, you can "hook into" the component
rendering lifecycle with callbacks.</p>
<p>You can define a function with any of the following names and expect it to be
invoked during it's namesake lifecycle phase: <code>initializedCallback</code>,
<code>mountCallback</code>, <code>prepareCallback</code>, <code>renderCallback</code>, <code>domCallback</code>,
<code>reconcileCallback</code>, and finally <code>updateCallback</code>.</p>
<p>See below for an example of defining a custom <code>prepareCallback</code> in order to
"hook into" the component rendering lifecycle to execute custom code. The
return value of this function is available to the <em>Template</em> Component Part when it
renders during the <code>render</code> lifecycle.</p>
<h5 id="example1preparecallback">Example 1: prepareCallback</h5><x-quickdemo mode="modulo" demo="modulo" value="&lt;Template&gt;
    {% for item in script.data %}&lt;p&gt;{{ item }}&lt;/p&gt;{% endfor %}
    &lt;p&gt;(C) {{ script.year }} All Rights Reserved&lt;/p&gt;
&lt;/Template&gt;
&lt;Script&gt;
    function prepareCallback() {
        return {
            data: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;],
            year: (new Date()).getFullYear(),
        };
    }
&lt;/Script&gt;
" modulo-mount-html=""></x-quickdemo>
<h5 id="example2allcallbacks">Example 2: All callbacks</h5><x-quickdemo mode="modulo" demo="modulo" value="&lt;Template&gt;
    &lt;label&gt;
        &lt;input state.bind name=&quot;enabled&quot; type=&quot;checkbox&quot; /&gt;
        Show messages in console
    &lt;/label&gt;
&lt;/Template&gt;
&lt;State
    enabled:=false
&gt;&lt;/State&gt;
&lt;Script&gt;
    function prepareCallback(renderObj) {
        _logInfo(&quot;prepare&quot;,  renderObj, { });
    }

    function renderCallback(renderObj) {
        _logInfo(&quot;render&quot;, renderObj);
    }

    function domCallback(renderObj) {
        _logInfo(&quot;dom&quot;, renderObj);
    }

    function reconcileCallback(renderObj) {
        _logInfo(&quot;reconcile&quot;, renderObj);
    }

    function updateCallback(renderObj) {
        _logInfo(&quot;update&quot;, renderObj, true);

    }

    let _table
    function _logInfo(phase, renderObj, newVal) {
        _table = _table || newVal
        if (state.enabled) {
            for (const key of Object.keys(renderObj)) {
                _table[key] = _table[key] || {}
                _table[key][phase] = renderObj[key]
            }
        }
        if (newVal === true &amp;&amp; Object.keys(_table).length) {
            console.group()
            console.table(_table)
            console.groupEnd()
            _table = { }
        }
    }
&lt;/Script&gt;
" modulo-mount-html=""></x-quickdemo>
<blockquote>
  <p><strong>Template literals?</strong> The back-tick syntax is <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">template literals</a>.</p>
</blockquote>
<h2 id="manualhtmlcreationwithscript">Manual HTML creation with Script</h2>
<blockquote>
  <p><strong>Template vs renderCallback</strong>
  Before replacing a <em>Template</em> with a <code>renderCallback</code>, first consider using
  prepareCallback or extending the templating language with a custom filter.
  The <em>Templating</em> language is intentionally limited and result in more
  readable code and a cleaner separation of concerns of logic (JavaScript) from
  presentation (HTML templates).</p>
</blockquote>
<p>You can use <em>Script</em> as a <em>Template</em> replacement, if necessary. For
fine-grained control over a component's rendered HTML, you can hook into the
<code>renderCallback</code>.  While not recommended for most usage, it remains an option
to use the <code>renderCallback</code> to write JS that constructs the HTML in a custom
fashion, such as using a third party templating system, or simply using
template literals.</p>
<p>For even greater control, you can simply replace the <code>innerHTML</code> of the entire
element. This will skip any virtual DOM or reconciler. Thus, we don't have
access to click events or binding, making many features less useful. Also note
that we can't use "onkeyup" but instead use "onchange" -- using the built-in
<code>element.innerHTML</code> causes the input to lose focus, otherwise.  Nonetheless,
it's still usable, and might be a useful example for fine-grained control.</p>
<p>See below for both examples:</p>
<h6 id="example1scriptwithouttemplate">Example 1: Script without Template</h6><x-quickdemo mode="modulo" demo="modulo" value="&lt;Script&gt;/* The classic To-Do App in Modulo (without using Template) */
   function renderCallback() {
        component.innerHTML = `&lt;ol&gt;${
                state.list.map(title =&gt; `
                    &lt;li&gt;${ title }&lt;/li&gt;
                `).join('')
            }&lt;li&gt;
                &lt;input state.bind name=&quot;text&quot; /&gt;
                &lt;button on.click=script.addItem&gt;Add&lt;/button&gt;
            &lt;/li&gt;
        &lt;/ol&gt;`
    }

    function addItem() {
        state.list.push(state.text); // add to list
        state.text = &quot;&quot;; // clear input
    }
&lt;/Script&gt;
&lt;State
    list:='[&quot;Milk&quot;, &quot;Bread&quot;, &quot;Candy&quot;]'
    text=&quot;Coffee&quot;
&gt;&lt;/State&gt;
&lt;Style&gt;
    li { color: indigo }
&lt;/Style&gt;
" modulo-mount-html=""></x-quickdemo>
<h6 id="example2scriptwithoutvirtualdom">Example 2: Script without Virtual DOM</h6><x-quickdemo mode="modulo" demo="modulo_embed" value="&lt;Component name=App&gt;
&lt;Script&gt; /* To-Do App (without using Template or a DOM reconciler) */
   function updateCallback() {
        const P3 = 'this.parentNode.parentNode.parentNode.cparts.'; //  parent is 3 nodes up
        element.innerHTML = `&lt;ol&gt;${
                state.list.map(title =&gt; `
                    &lt;li&gt;${ title }&lt;/li&gt;
                `).join('')
            }&lt;li&gt;
              &lt;input value=&quot;${ state.text }&quot;
                     onchange=&quot;${ P3 }state.propagate('text', this.value, this)&quot;&gt;
              &lt;button onclick=&quot;${ P3 }script.addItemCallback()&quot;&gt;Add&lt;/button&gt;
            &lt;/li&gt;
        &lt;/ol&gt;`;
    }

    function addItemCallback() {
        state.list.push(state.text); // add to list
        state.text = &quot;&quot;; // clear input
        element.rerender(); // Ensure rerender
    }
&lt;/Script&gt;
&lt;State
    list:='[&quot;Milk&quot;, &quot;Bread&quot;, &quot;Candy&quot;]'
    text=&quot;Coffee&quot;
&gt;&lt;/State&gt;
&lt;Style&gt;
    li { color: indigo }
&lt;/Style&gt;
&lt;/Component&gt;
" modulo-mount-html=""></x-quickdemo>
</div>
                
            
        </main>
    </div></x-page></body></html>